{% extends 'base.html' %}

{% block title %}–£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –ø–∞—Ä–∞–º–µ—Ç—Ä–∞–º–∏ - Engine View{% endblock %}

{% block content %}
<div class="row">
    <div class="col-12">
        <div class="d-flex justify-content-between align-items-center mb-4">
            <h2>‚öôÔ∏è –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –ø–∞—Ä–∞–º–µ—Ç—Ä–∞–º–∏</h2>
            <a href="{% url 'monitoring:import_csv' %}" class="btn btn-primary">
                üì§ –ò–º–ø–æ—Ä—Ç CSV
            </a>
        </div>

        <div class="card">
            <div class="card-header">
                <h5 class="mb-0">üìä –í—Å–µ –ø–∞—Ä–∞–º–µ—Ç—Ä—ã —Å–∏—Å—Ç–µ–º—ã</h5>
            </div>
            <div class="card-body">
                <div class="table-responsive">
                    <table class="table table-striped">
                        <thead>
                            <tr>
                                <th>–ù–∞–∑–≤–∞–Ω–∏–µ</th>
                                <th>–ö–æ–¥</th>
                                <th>–ï–¥–∏–Ω–∏—Ü—ã</th>
                                <th>–¢–∏–ø</th>
                                <th>–ò—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è</th>
                                <th>–°—Ç–∞—Ç—É—Å</th>
                                <th>–î–µ–π—Å—Ç–≤–∏—è</th>
                            </tr>
                        </thead>
                        <tbody>
                            {% for param in parameters %}
                            <tr>
                                <td>{{ param.name }}</td>
                                <td><code>{{ param.code }}</code></td>
                                <td>{{ param.unit|default:"-" }}</td>
                                <td>
                                    {% if param.unit %}
                                        <span class="badge bg-info">–ß–∏—Å–ª–æ–≤–æ–π</span>
                                    {% else %}
                                        <span class="badge bg-warning">–¢–µ–∫—Å—Ç–æ–≤—ã–π</span>
                                    {% endif %}
                                </td>
                                <td>
                                    {{ param.parametervalue_set.count }} —Ä–∞–∑
                                </td>
                                <td>
                                    {% if param.is_active %}
                                        <span class="badge bg-success">–ê–∫—Ç–∏–≤–µ–Ω</span>
                                    {% else %}
                                        <span class="badge bg-secondary">–í—ã–∫–ª—é—á–µ–Ω</span>
                                    {% endif %}
                                </td>
                                <td>
                                    <!-- –í–°–¢–ê–í–ò–õ –£–õ–£–ß–®–ï–ù–ù–´–ï –ö–ù–û–ü–ö–ò –ó–î–ï–°–¨ -->
                                    <div class="btn-group btn-group-sm">
                                        <a href="{% url 'monitoring:edit_parameter' param.pk %}" 
                                        class="btn btn-outline-primary" title="–†–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞—Ç—å">
                                            ‚úèÔ∏è –†–µ–¥–∞–∫—Ç
                                        </a>
                                        <form method="post" class="d-inline">
                                            {% csrf_token %}
                                            <input type="hidden" name="parameter_id" value="{{ param.pk }}">
                                            <button type="submit" name="action" value="toggle" 
                                                    class="btn btn-outline-{% if param.is_active %}warning{% else %}success{% endif %}"
                                                    title="{% if param.is_active %}–í—ã–∫–ª—é—á–∏—Ç—å{% else %}–í–∫–ª—é—á–∏—Ç—å{% endif %}">
                                                {% if param.is_active %}üî¥{% else %}üü¢{% endif %}
                                            </button>
                                        </form>
                                        {% if param.parametervalue_set.count == 0 %}
                                        <form method="post" class="d-inline" 
                                            onsubmit="return confirm('–£–¥–∞–ª–∏—Ç—å –ø–∞—Ä–∞–º–µ—Ç—Ä \"{{ param.name }}\"?')">
                                            {% csrf_token %}
                                            <input type="hidden" name="parameter_id" value="{{ param.pk }}">
                                            <button type="submit" name="action" value="delete" 
                                                    class="btn btn-outline-danger" title="–£–¥–∞–ª–∏—Ç—å">
                                                üóëÔ∏è
                                            </button>
                                        </form>
                                        {% else %}
                                        <button class="btn btn-outline-secondary" disabled title="–ù–µ–ª—å–∑—è —É–¥–∞–ª–∏—Ç—å (–∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è)">
                                            üö´
                                        </button>
                                        {% endif %}
                                    </div>
                                </td>
                            </tr>
                            {% empty %}
                            <tr>
                                <td colspan="7" class="text-center text-muted">
                                    –ü–∞—Ä–∞–º–µ—Ç—Ä—ã –Ω–µ –Ω–∞–π–¥–µ–Ω—ã
                                </td>
                            </tr>
                            {% endfor %}
                        </tbody>
                    </table>
                </div>
            </div>
        </div>

        <div class="card mt-4">
            <div class="card-header">
                <h5 class="mb-0">üí° –ü–æ–¥—Å–∫–∞–∑–∫–∏</h5>
            </div>
            <div class="card-body">
                <ul>
                    <li><strong>üü¢ –ê–∫—Ç–∏–≤–Ω—ã–µ –ø–∞—Ä–∞–º–µ—Ç—Ä—ã</strong> - –æ—Ç–æ–±—Ä–∞–∂–∞—é—Ç—Å—è –≤ —Ñ–æ—Ä–º–∞—Ö –∏ –∏–º–ø–æ—Ä—Ç–µ</li>
                    <li><strong>üî¥ –í—ã–∫–ª—é—á–µ–Ω–Ω—ã–µ –ø–∞—Ä–∞–º–µ—Ç—Ä—ã</strong> - —Å–∫—Ä—ã—Ç—ã –∏–∑ —Ñ–æ—Ä–º, –Ω–æ –¥–∞–Ω–Ω—ã–µ —Å–æ—Ö—Ä–∞–Ω—è—é—Ç—Å—è</li>
                    <li><strong>üóëÔ∏è –£–¥–∞–ª–µ–Ω–∏–µ</strong> - –¥–æ—Å—Ç—É–ø–Ω–æ —Ç–æ–ª—å–∫–æ –¥–ª—è –Ω–µ–∏—Å–ø–æ–ª—å–∑—É–µ–º—ã—Ö –ø–∞—Ä–∞–º–µ—Ç—Ä–æ–≤</li>
                    <li><strong>üìä –ß–∏—Å–ª–æ–≤—ã–µ –ø–∞—Ä–∞–º–µ—Ç—Ä—ã</strong> - –∏–º–µ—é—Ç –µ–¥–∏–Ω–∏—Ü—ã –∏–∑–º–µ—Ä–µ–Ω–∏—è –∏ –∏—Å–ø–æ–ª—å–∑—É—é—Ç—Å—è –≤ –≥—Ä–∞—Ñ–∏–∫–∞—Ö</li>
                    <li><strong>üìù –¢–µ–∫—Å—Ç–æ–≤—ã–µ –ø–∞—Ä–∞–º–µ—Ç—Ä—ã</strong> - –±–µ–∑ –µ–¥–∏–Ω–∏—Ü –∏–∑–º–µ—Ä–µ–Ω–∏—è, —Ç–æ–ª—å–∫–æ –¥–ª—è –æ—Ç–æ–±—Ä–∞–∂–µ–Ω–∏—è</li>
                </ul>
            </div>
        </div>
    </div>
</div>
{% endblock %}